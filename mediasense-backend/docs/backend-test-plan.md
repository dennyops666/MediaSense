# 后端测试计划

## 1. 测试概述

### 1.1 测试目标
- 验证所有后端功能模块的正确性和稳定性
- 确保系统性能满足需求
- 发现并修复潜在的缺陷和安全问题
- 验证系统的可扩展性和可维护性

### 1.2 测试范围
- 单元测试
- 集成测试
- 性能测试
- 安全测试

### 1.3 测试优先级
- P0: 阻塞性问题（需立即解决）
  - 影响系统核心功能的严重缺陷
  - 导致系统无法启动或崩溃的问题
  - 数据安全相关的严重漏洞
  - 影响生产环境稳定性的问题

- P1: 核心功能问题（影响业务运行）
  - 核心业务流程的功能缺陷
  - 影响用户主要使用场景的问题
  - 性能显著低于预期的情况
  - 需要及时修复的安全隐患

- P2: 非核心功能问题（影响用户体验）
  - 次要功能的缺陷
  - UI/UX相关的问题
  - 性能优化需求
  - 可用性改进项

- P3: 优化类问题（可延后处理）
  - 代码质量优化
  - 文档完善
  - 小功能改进
  - 非紧急的性能优化

### 1.4 状态标记
- Not Started: 未开始
- In Progress: 进行中
- Completed: 已完成
- Failed: 未通过
- Blocked: 被阻塞

### 1.5 测试环境
- 操作系统: Linux
- Python版本: 3.8+
- 数据库: MySQL 8.0
- 缓存: Redis 6.0
- 搜索引擎: Elasticsearch 7.x

### 1.6 测试工具
- pytest==8.1.1
- pytest-django==4.8.0
- pytest-cov==5.0.0
- factory-boy==3.3.0
- faker==24.3.0
- coverage==7.4.3
- freezegun==1.4.0
- pytest-mock==3.12.0
- pytest-xdist==3.5.0
- pytest-sugar==1.0.0
- pytest-timeout==2.3.1

## 2. P0级测试计划（阻塞性问题）

### 2.1 认证核心服务

#### TC-AUTH-001: 用户登录流程
- **优先级**: P0
- **状态**: Not Started
- **前置条件**: 
  - 系统中存在有效的用户账号
  - 数据库和缓存服务正常运行
- **测试步骤**:
  1. 使用正确的用户名和密码登录
  2. 使用错误的密码登录
  3. 使用不存在的用户名登录
  4. 使用已被封禁的账号登录
- **预期结果**:
  - 正确凭证登录成功，返回有效token
  - 错误密码登录失败，返回密码错误提示
  - 不存在用户名登录失败，返回用户不存在提示
  - 封禁账号登录失败，返回账号已封禁提示

#### TC-AUTH-002: JWT Token验证
- **优先级**: P0
- **状态**: Not Started
- **前置条件**: 
  - 用户已成功登录
  - 系统持有有效的JWT token
- **测试步骤**:
  1. 使用有效token访问受保护接口
  2. 使用过期token访问接口
  3. 使用无效token访问接口
  4. 使用被加入黑名单的token访问
- **预期结果**:
  - 有效token可以正常访问接口
  - 过期token返回过期错误
  - 无效token返回验证失败错误
  - 黑名单token被拒绝访问

### 2.2 数据库服务

#### TC-DB-001: 数据库连接池
- **优先级**: P0
- **状态**: Not Started
- **前置条件**:
  - MySQL服务正常运行
  - 连接池配置完成
- **测试步骤**:
  1. 测试连接池初始化
  2. 并发请求获取连接
  3. 测试连接超时处理
  4. 测试连接释放机制
  5. 测试连接池满载情况
- **预期结果**:
  1. 连接池正确初始化
  2. 并发请求正常处理
  3. 超时情况正确处理
  4. 连接正确释放回池
  5. 满载时请求正确排队

#### TC-DB-002: 数据库事务
- **优先级**: P0
- **状态**: Not Started
- **前置条件**:
  - 数据库服务正常
  - 测试数据已准备
- **测试步骤**:
  1. 执行单表事务操作
  2. 执行多表事务操作
  3. 测试事务回滚
  4. 测试事务隔离级别
  5. 测试死锁处理
- **预期结果**:
  1. 单表事务正确提交或回滚
  2. 多表事务保持一致性
  3. 回滚操作正确执行
  4. 隔离级别正确生效
  5. 死锁被检测并处理

### 2.3 缓存服务

#### TC-CACHE-001: Redis连接管理
- **优先级**: P0
- **状态**: Not Started
- **前置条件**:
  - Redis服务正常运行
  - 缓存配置完成
- **测试步骤**:
  1. 测试Redis连接建立
  2. 测试连接池管理
  3. 测试连接失败恢复
  4. 测试连接超时处理
  5. 测试哨兵模式切换
- **预期结果**:
  1. 连接正常建立
  2. 连接池正确管理连接
  3. 连接失败后自动恢复
  4. 超时情况正确处理
  5. 主从切换正常进行

## 3. P1级测试计划（核心功能）

### 3.1 用户管理

#### TC-AUTH-003: 用户注册流程
- **优先级**: P1
- **状态**: Not Started
- **前置条件**:
  - 系统正常运行
  - 数据库可写入
- **测试步骤**:
  1. 使用有效信息注册新用户
  2. 使用已存在的用户名注册
  3. 使用无效的邮箱格式注册
  4. 使用不符合要求的密码注册
- **预期结果**:
  - 有效信息注册成功
  - 重复用户名注册失败
  - 无效邮箱格式注册失败
  - 不合格密码注册失败

### 3.2 新闻管理

#### TC-NEWS-001: 新闻CRUD操作
- **优先级**: P1
- **状态**: Not Started
- **前置条件**:
  - 用户已登录
  - 具有相应权限
- **测试步骤**:
  1. 创建新闻文章
  2. 读取新闻详情
  3. 更新新闻内容
  4. 删除新闻文章
  5. 批量操作新闻
- **预期结果**:
  1. 新闻创建成功
  2. 正确显示新闻信息
  3. 更新内容正确保存
  4. 删除操作正确执行
  5. 批量操作正确完成

### 3.3 搜索服务

#### TC-SEARCH-001: 新闻搜索功能
- **优先级**: P1
- **状态**: Not Started
- **前置条件**:
  - Elasticsearch服务正常运行
  - 索引数据已建立
- **测试步骤**:
  1. 基础关键词搜索
  2. 高级过滤搜索
  3. 分页获取结果
  4. 结果排序功能
  5. 搜索建议功能
- **预期结果**:
  1. 关键词搜索结果准确
  2. 过滤条件正确应用
  3. 分页功能正常工作
  4. 排序功能正确执行
  5. 搜索建议相关且及时

### 3.4 AI服务

#### TC-AI-001: 文本分析服务
- **优先级**: P1
- **状态**: Not Started
- **前置条件**:
  - OpenAI API配置正确
  - 测试数据准备完成
- **测试步骤**:
  1. 情感分析处理
  2. 关键词提取
  3. 文本摘要生成
  4. 批量分析任务
  5. 分析结果存储
- **预期结果**:
  1. 情感分析结果准确
  2. 关键词提取合理
  3. 摘要生成完整
  4. 批量任务正常执行
  5. 结果正确保存

### 3.5 监控服务

#### TC-MONITOR-001: 系统监控功能
- **优先级**: P1
- **状态**: Not Started
- **前置条件**:
  - 监控服务正常运行
  - 数据采集配置完成
- **测试步骤**:
  1. 系统指标采集
  2. 性能数据监控
  3. 告警规则触发
  4. 监控数据可视化
  5. 告警通知发送
- **预期结果**:
  1. 指标采集准确完整
  2. 性能监控实时有效
  3. 告警规则正确触发
  4. 可视化展示正常
  5. 通知及时送达

## 4. P2级测试计划（非核心功能）

### 4.1 用户功能

#### TC-AUTH-004: 密码重置功能
- **优先级**: P2
- **状态**: Not Started
- **前置条件**:
  - 系统中存在注册用户
  - 邮件服务配置正确
- **测试步骤**:
  1. 请求密码重置
  2. 使用新密码登录
- **预期结果**:
  - 重置请求成功提交
  - 重置邮件成功发送
  - 密码成功修改
  - 新密码可以正常登录

### 4.2 爬虫功能

#### TC-CRAWLER-001: 爬虫配置管理
- **优先级**: P2
- **状态**: Not Started
- **前置条件**:
  - 爬虫服务正常运行
  - 测试目标网站可访问
- **测试步骤**:
  1. 创建爬虫配置
  2. 修改爬虫规则
  3. 启动爬虫任务
  4. 暂停爬虫任务
  5. 查看任务状态
- **预期结果**:
  1. 配置创建成功
  2. 规则修改生效
  3. 任务正常启动
  4. 任务成功暂停
  5. 状态查看准确

### 4.3 新闻分类管理

#### TC-NEWS-002: 新闻分类功能
- **优先级**: P2
- **状态**: Not Started
- **前置条件**:
  - 用户已登录
  - 具有分类管理权限
- **测试步骤**:
  1. 创建新闻分类
  2. 编辑分类信息
  3. 删除新闻分类
  4. 分类新闻关联
  5. 分类统计查看
- **预期结果**:
  1. 分类创建成功
  2. 信息修改生效
  3. 删除操作完成
  4. 关联关系正确
  5. 统计数据准确

## 5. 测试执行记录

### 5.1 测试进度表
| 测试用例ID | 优先级 | 状态 | 执行时间 | 执行人 | 备注 |
|------------|--------|------|----------|--------|------|
| TC-AUTH-001 | P0 | Passed | 2024-03-21 | denny | 用户登录测试通过 |
| TC-AUTH-002 | P0 | Passed | 2024-03-21 | denny | JWT Token验证测试通过 |
| TC-DB-001  | P0 | Not Started | | | |
| TC-DB-002  | P0 | Not Started | | | |
| TC-CACHE-001| P0 | Not Started | | | |
| TC-AUTH-003 | P1 | Passed | 2024-03-21 | denny | 用户注册测试通过 |
| TC-NEWS-001| P1 | Not Started | | | |
| TC-SEARCH-001| P1 | Not Started | | | |
| TC-AI-001  | P1 | Not Started | | | |
| TC-MONITOR-001| P1 | Not Started | | | |
| TC-AUTH-004 | P2 | Passed | 2024-03-21 | denny | 密码重置和并发认证测试通过 |
| TC-CRAWLER-001| P2 | Not Started | | | |
| TC-NEWS-002| P2 | Not Started | | | |

### 5.2 问题记录表
| 问题ID | 关联用例 | 优先级 | 状态 | 描述 | 解决方案 |
|--------|----------|---------|------|------|----------|
| | | | | | |

## 6. 测试报告模板

### 6.1 测试概要
- 测试范围
- 测试环境
- 测试工具
- 测试时间

### 6.2 测试结果
- 测试用例统计
- 缺陷统计分析
- 测试覆盖率
- 性能指标

### 6.3 问题记录
- 问题描述
- 重现步骤
- 影响范围
- 解决方案

### 6.4 改进建议
- 测试过程优化
- 自动化建议
- 性能优化
- 安全加固 